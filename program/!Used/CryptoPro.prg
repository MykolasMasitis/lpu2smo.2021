PROCEDURE CryptoPro
LOCAL loCertificateStore, loCertificates  
  LOCAL lnCount, lnStatus  
    
  #INCLUDE DigtCrypto.h  
    
  SET DATE GERMAN   
  SET CENTURY ON   
    
  loCertificateStore = CREATEOBJECT("DigtCrypto.CertificateStore")  
  loCertificateStore.Open(CURRENT_USER_STORE, "my")  
  loCertificates = loCertificateStore.Store  
  FOR lnCount=0 TO loCertificates.Count-1  
  	CLEAR  
  	WITH loCertificates.Item(lnCount)  
  		?"Certificate #", lnCount+1  
  		?"ID=",.ID  
  		?"IssuerName=",.IssuerName  
  		?"SubjectName=",.SubjectName  
  		?"CertContext=",.CertContext  
  		?"ContainerName=",.ContainerName  
  		?"EKU=",.EKU  
  		?"KU=",.KU  
  		?  
  		?"Profile.ID=",.Profile.ID  
  		?"Profile.Name=",.Profile.Name  
  		?"Profile.Provider=",.Profile.Provider  
  		?"Profile.Description=",.Profile.Description  
  		?"Profile.Comment=",.Profile.Comment  
  		?"Profile.DefaultPath=",.Profile.DefaultPath  
  		?"Profile.InputFiles=",.Profile.InputFiles  
  		?"Profile.OutputFiles=",.Profile.OutputFiles  
  		?  
  		?"ProviderName=",.ProviderName  
  		?"PublicKey(BASE64_TYPE)=",.PublicKey(BASE64_TYPE)  
  		?"PublicKey(DER_TYPE)=",.PublicKey(DER_TYPE)  
  		?"PublicKeyAlg=",.PublicKeyAlg  
  		?"SerialNumber=",.SerialNumber  
  		?"ValidFrom=",.ValidFrom  
  		?"ValidTo=",.ValidTo  
  		?"SignatureAlg=",.SignatureAlg  
  		?"ThumbPrint=",.ThumbPrint  
  		lnStatus = -1  
  		lnStatus = .IsValid(POLICY_TYPE_NONE)	&& ???????? ?????? ???????????   
  		DO CASE   
  			CASE lnStatus = VS_CORRECT  
  				?"Status: ????????? "  
  			CASE lnStatus = VS_UNSUFFICIENT_INFO  
  				?"Status: ?????? ??????????"  
  			CASE lnStatus = VS_UNCORRECT  
  				?"Status: ???????????"  
  			CASE lnStatus = VS_INVALID_CERTIFICATE_BLOB  
  				?"Status: ???????????????? ???? ???????????"  
  			CASE lnStatus = VS_CERTIFICATE_TIME_EXPIRIED  
  				?"Status: ????? ???????? ??????????? ??????? ??? ??? ?? ?????????"  
  			CASE lnStatus = VS_CERTIFICATE_NO_CHAIN  
  				?"Status: ?????????? ????????? ??????? ????????????"  
  			CASE lnStatus = VS_CERTIFICATE_CRL_UPDATING_ERROR  
  				?"Status: ?????? ?????????? ???????????"  
  			CASE lnStatus = VS_LOCAL_CRL_NOT_FOUND  
  				?"Status: ?? ?????? ????????? ???"   
  			CASE lnStatus = VS_CRL_TIME_EXPIRIED  
  				?"Status: ??????? ????? ???????? ???"  
  			CASE lnStatus = VS_CERTIFICATE_IN_CRL  
  				?"Status: ????????? ????????? ? ???"  
  			CASE lnStatus = VS_CERTIFICATE_IN_LOCAL_CRL  
  				?"Status: ????????? ????????? ? ????????? ???"  
  			CASE lnStatus = VS_CERTIFICATE_CORRECT_BY_LOCAL_CRL  
  				?"Status: ?????????? ???????????? ?? ?????????? ???"  
  			CASE lnStatus = VS_CERTIFICATE_USING_RESTRICTED  
  				?"Status: ????????????? ??????????? ??????????"  
  		ENDCASE  		  
  		?"========================================"  
  		WAIT   
  	ENDWITH   
  NEXT lnCount
RETURN 